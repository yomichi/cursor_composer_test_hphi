# run_calculations.py のテスト戦略

## 1. ユニットテスト

### コマンドライン引数のパース（`test_parse_args`）
- デフォルト値の確認
  - `--work-dir`が`.`になっているか
- 各引数の型の確認
  - `work_dir`が文字列型か
- 不正な入力のエラー処理
  - 存在しないディレクトリを指定した場合

### 計算ディレクトリの検索（`test_find_calculation_dirs`）
- 正常系
  - 指定したディレクトリ内のN*ディレクトリを検出できるか
  - ディレクトリのソート順が正しいか（N4, N6, N8, ...）
- 異常系
  - dataディレクトリが存在しない場合
  - N*ディレクトリが存在しない場合
  - StdFace.defが存在しない場合

### HPhi実行（`test_run_hphi`）
- 正常系
  - HPhi実行時の作業ディレクトリの変更
  - HPhi実行時のコマンド
  - 実行結果の確認
- 異常系
  - HPhi実行失敗時のエラー処理
  - 実行権限がない場合のエラー処理

### 結果の移動（`test_move_results`）
- 正常系
  - 結果ファイルの移動
  - ディレクトリ構造の確認
  - ファイルの存在確認
- 異常系
  - 移動先ディレクトリの作成失敗
  - 結果ファイルが存在しない場合
  - 移動先に同名ファイルが存在する場合

## 2. 統合テスト

### メイン処理の実行（`test_main`）
- 正常系
  - 全体の処理が正しく実行されるか
  - 結果ファイルの配置確認
  - 進捗表示の確認
- 異常系
  - エラー時の終了コードの確認
  - エラーメッセージの出力確認

## 3. テストケースの優先順位

### 1. 基本機能のテスト
- [ ] コマンドライン引数の処理
  - [ ] デフォルト値の確認
  - [ ] カスタム値の確認
- [ ] 計算ディレクトリの検索
  - [ ] ディレクトリの検出
  - [ ] ソート順の確認

### 2. HPhi実行のテスト
- [ ] HPhi実行の制御
  - [ ] コマンド実行
  - [ ] 作業ディレクトリの管理
- [ ] 実行結果の確認
  - [ ] 終了コードの確認
  - [ ] 出力ファイルの確認

### 3. 結果ファイルの管理
- [ ] 結果ディレクトリの作成
  - [ ] ディレクトリ構造の作成
  - [ ] 権限の確認
- [ ] ファイルの移動
  - [ ] ファイルのコピー
  - [ ] 元ファイルの削除

### 4. エッジケース
- [ ] エラー処理
  - [ ] HPhi実行エラー
  - [ ] ファイル操作エラー
  - [ ] 権限エラー
- [ ] 異常な状況
  - [ ] 不完全な計算結果
  - [ ] 破損したファイル
  - [ ] 予期しないディレクトリ構造 
