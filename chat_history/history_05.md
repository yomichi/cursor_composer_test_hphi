### #5

ハミルトニアンをもう少し具体的に書く

#### In

反強磁性XXZ 模型、すなわち

$$H = J \sum_i \left[ S_{i}^x S_{i+1}^x + S_{i}^y S_{i+1}^y + \Delta S_{i}^zS_{i+1}^z \right]$$

を考えます。
パラメータとして

- スピンの大きさS
- イジング異方性 Delta

をコマンドライン引数で与えられるようにしてください。

#### Out

反強磁性XXZ模型のパラメータを追加し、仕様書を更新します。

````markdown:references/specification.md
# スピン鎖のエネルギーギャップ計算戦略

## 目的
- スピン鎖のエネルギーギャップのサイズ依存性を、厳密対角化ソルバーHPhiを用いて計算する
- 結果を可視化し、有限サイズスケーリング解析を行う

## 物理系
反強磁性XXZ模型：

$$H = J \sum_i \left[ S_{i}^x S_{i+1}^x + S_{i}^y S_{i+1}^y + \Delta S_{i}^zS_{i+1}^z \right]$$

### パラメータ
- \(S\)：スピンの大きさ（S = 1/2, 1, 3/2, ...）
- \(\Delta\)：イジング異方性
- \(J > 0\)：反強磁性的な結合定数（J = 1に固定）

## 実装手順

### 1. HPhiの入力ファイル生成
- 異なるサイズ（N = 4, 6, 8, 10, 12など）のスピン鎖に対する入力ファイルを自動生成
  - `StdFace.def`：基本パラメータの設定
    - モデル：`model = "SpinGC"`
    - スピンの大きさ：`2S`の値を指定
    - 格子：1次元鎖
  - `hamiltonian.def`：ハミルトニアンの定義
    - 最近接相互作用のみ
    - XY項の係数：J = 1.0（固定）
    - Z項の係数：J * Δ
  - サイズごとに別のディレクトリを作成

### スクリプトのオプション
```
共通オプション：
  --work-dir DIR    作業ディレクトリ（デフォルト：カレントディレクトリ）
  --2s INTEGER      スピンの大きさ2S（必須）
  --delta FLOAT     イジング異方性Δ（必須）

generate_input.py の追加オプション：
  --sizes LIST      計算するシステムサイズのリスト（デフォルト：[4,6,8,10,12]）
```

### スクリプトの使用例
```bash
# S=1/2, Δ=1.0（Heisenberg模型）の場合
python src/generate_input.py --2s 1 --delta 1.0

# S=1, Δ=0（XY模型）の場合、作業ディレクトリを指定
python src/generate_input.py --2s 2 --delta 0.0 --work-dir ./work

# カスタムサイズを指定
python src/generate_input.py --2s 1 --delta 1.0 --sizes 4,6,8
```

// ... existing code ...

## 注意点
1. メモリ使用量の考慮
   - システムサイズに応じて必要なメモリ量が指数関数的に増加
   - スピンの大きさSに応じて状態数が増大（(2S+1)^N）
   - 利用可能なリソースに応じて最大サイズを設定

2. 計算効率
   - HPhi の OpenMP 並列化を活用
   - 計算時のスレッド数を適切に設定

3. エラー処理
   - パラメータの妥当性チェック
     - 2Sは正の整数
     - Δは実数
   - 計算の収束確認
   - 異常終了時のエラーハンドリング

4. 作業ディレクトリの管理
   - 絶対パスと相対パスの適切な処理
   - 既存ディレクトリの存在確認とバックアップ
   - 一時ファイルの適切な管理
````


仕様書を更新し、以下の変更を行いました：

1. 物理系の明確化：
   - XXZ模型のハミルトニアンを数式で記述
   - パラメータの説明を追加（S, Δ, J）
   - Jは1に固定することを明記

2. HPhiの入力ファイル生成の詳細化：
   - `StdFace.def`の設定項目を具体化
   - `hamiltonian.def`の設定内容を明確化

3. コマンドラインオプションの仕様追加：
   - `--2s`：スピンの大きさを2Sで指定（整数値）
   - `--delta`：イジング異方性Δ
   - `--sizes`：計算するシステムサイズのリスト（オプション）

4. 使用例の追加：
   - S=1/2のHeisenberg模型（Δ=1）
   - S=1のXY模型（Δ=0）
   - カスタムサイズ指定の例

5. 注意点の更新：
   - メモリ使用量の考慮にスピンの大きさの影響を追加
   - パラメータの妥当性チェックに関する項目を追加

次のステップとして、これらの仕様に基づいて`generate_input.py`の実装を始めることができます。実装を始めましょうか？


